[
  {
    "type": "effect_on_condition",
    "id": "EOC_XE_CHANGELING_GRANT_POWER_VITAMIN_RECURRING",
    "recurrence": [ "8 days", "10 days" ],
    "condition": { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
    "effect": { "math": [ "u_changeling_advancement_dreams_counter++" ] }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_NOBLE_ADD_POWER_QUEUE_ON_GAME_START",
    "eoc_type": "EVENT",
    "required_event": "game_start",
    "condition": { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" },
    "effect": { "math": [ "u_changeling_advancement_dreams_counter++" ] }
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS" },
    "effect": [
      {
        "u_message": "That night, you dream of your parents and the unknown place of your birth.  Who were they?",
        "type": "info"
      },
      {
        "run_eoc_selector": [
          "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_BROWNIE",
          "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_POOKA",
          "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_SELKIE",
          "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_TROW"
        ],
        "names": [ "Brownie", "Pooka", "Selkie", "Trow" ],
        "title": "What is your heritage?",
        "descriptions": [
          "Your parents were brownies, the simple, down-to-earth crafters of the fae.",
          "Your parents were pookas, shapechangers that can take animal forms.",
          "Your parents were selkies, who spend part of the time upon land and part of the time as a seal in the sea",
          "Your parents were trow, tough as stone, who dwell beneath the earth."
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_BROWNIE",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS" },
    "effect": [
      { "u_add_trait": "UNKNOWING_CHANGELING_COMMONER_BROWNIE" },
      { "u_lose_trait": "FAIR_FOLK_COMMONER_SELECTOR" },
      { "u_message": "XE_CHANGELING_COMMONER_BROWNIE", "type": "neutral", "snippet": true },
      { "run_eocs": "EOC_PLAYABLE_CHANGELING_BROWNIE_GAIN_NEW_TRAIT" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_POOKA",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS" },
    "effect": [
      { "u_add_trait": "UNKNOWING_CHANGELING_COMMONER_POOKA" },
      { "u_lose_trait": "FAIR_FOLK_COMMONER_SELECTOR" },
      { "u_message": "XE_CHANGELING_COMMONER_POOKA", "type": "neutral", "snippet": true },
      { "run_eocs": "EOC_PLAYABLE_CHANGELING_POOKA_GAIN_NEW_TRAIT" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_SELKIE",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS" },
    "effect": [
      { "u_add_trait": "UNKNOWING_CHANGELING_COMMONER_SELKIE" },
      { "u_lose_trait": "FAIR_FOLK_COMMONER_SELECTOR" },
      { "u_message": "XE_CHANGELING_COMMONER_SELKIE", "type": "neutral", "snippet": true },
      { "run_eocs": "EOC_PLAYABLE_CHANGELING_SELKIE_GAIN_NEW_TRAIT" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_COMMONER_CHOOSE_HERITAGE_TROW",
    "condition": { "test_eoc": "EOC_TEST_CHANGELING_COMMONER_INITIAL_CONDITIONS" },
    "effect": [
      { "u_add_trait": "UNKNOWING_CHANGELING_COMMONER_TROW" },
      { "u_lose_trait": "FAIR_FOLK_COMMONER_SELECTOR" },
      { "u_message": "XE_CHANGELING_COMMONER_TROW", "type": "neutral", "snippet": true },
      { "run_eocs": "EOC_PLAYABLE_CHANGELING_TROW_GAIN_NEW_TRAIT" }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_NOBLE_NEW_POWERS",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": {
      "and": [ { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" }, { "math": [ "u_changeling_advancement_dreams_counter >= 1" ] } ]
    },
    "effect": [
      {
        "run_eocs": [
          {
            "id": "EOC_PLAYABLE_CHANGELING_NOBLE_GAIN_NEW_TRAIT",
            "effects": [
              { "u_message": "XE_CHANGELING_NOBLE", "type": "neutral", "snippet": true },
              { "math": [ "u_vitamin('mutagen_fair_folk_noble')", "+=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "+=", "1000" ] },
              { "u_mutate": 0 },
              { "math": [ "u_vitamin('mutagen_fair_folk_noble')", "-=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "-=", "1000" ] },
              { "math": [ "u_changeling_advancement_dreams_counter--" ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_BROWNIE_NEW_POWERS",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_BROWNIE" },
        { "math": [ "u_changeling_advancement_dreams_counter >= 1" ] }
      ]
    },
    "effect": [
      {
        "run_eocs": [
          {
            "id": "EOC_PLAYABLE_CHANGELING_BROWNIE_GAIN_NEW_TRAIT",
            "effects": [
              { "u_message": "XE_CHANGELING_COMMONER_BROWNIE", "type": "neutral", "snippet": true },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_brownie')", "+=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "+=", "1000" ] },
              { "u_mutate": 0 },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_brownie')", "-=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "-=", "1000" ] },
              { "math": [ "u_changeling_advancement_dreams_counter--" ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_POOKA_NEW_POWERS",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_POOKA" },
        { "math": [ "u_changeling_advancement_dreams_counter >= 1" ] }
      ]
    },
    "effect": [
      {
        "run_eocs": [
          {
            "id": "EOC_PLAYABLE_CHANGELING_POOKA_GAIN_NEW_TRAIT",
            "effects": [
              { "u_message": "XE_CHANGELING_COMMONER_POOKA", "type": "neutral", "snippet": true },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_pooka')", "+=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "+=", "1000" ] },
              { "u_mutate": 0 },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_pooka')", "-=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "-=", "1000" ] },
              { "math": [ "u_changeling_advancement_dreams_counter--" ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_SELKIE_NEW_POWERS",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_SELKIE" },
        { "math": [ "u_changeling_advancement_dreams_counter >= 1" ] }
      ]
    },
    "effect": [
      {
        "run_eocs": [
          {
            "id": "EOC_PLAYABLE_CHANGELING_SELKIE_GAIN_NEW_TRAIT",
            "effects": [
              { "u_message": "XE_CHANGELING_COMMONER_SELKIE", "type": "neutral", "snippet": true },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_selkie')", "+=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "+=", "1000" ] },
              { "u_mutate": 0 },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_selkie')", "-=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "-=", "1000" ] },
              { "math": [ "u_changeling_advancement_dreams_counter--" ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_TROW_NEW_POWERS",
    "eoc_type": "EVENT",
    "required_event": "character_wakes_up",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_TROW" },
        { "math": [ "u_changeling_advancement_dreams_counter >= 1" ] }
      ]
    },
    "effect": [
      {
        "run_eocs": [
          {
            "id": "EOC_PLAYABLE_CHANGELING_TROW_GAIN_NEW_TRAIT",
            "effects": [
              { "u_message": "XE_CHANGELING_COMMONER_TROW", "type": "neutral", "snippet": true },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_trow')", "+=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "+=", "1000" ] },
              { "u_mutate": 0 },
              { "math": [ "u_vitamin('mutagen_fair_folk_commoner_trow')", "-=", "2500" ] },
              { "math": [ "u_vitamin('mutagen')", "-=", "1000" ] },
              { "math": [ "u_changeling_advancement_dreams_counter--" ] }
            ]
          }
        ]
      }
    ]
  },
  {
    "//": "Advancement conditions that apply to all changelings should go here",
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_KILL_MARCH_LORD",
    "eoc_type": "EVENT",
    "required_event": "character_kills_monster",
    "condition": {
      "and": [
        { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
        { "compare_string": [ { "context_val": "victim_type" }, "mon_march_lord" ] }
      ]
    },
    "effect": [ { "math": [ "u_changeling_advancement_dreams_counter++" ] } ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_FOUND_BOANNS_ISLAND",
    "eoc_type": "EVENT",
    "required_event": "avatar_enters_omt",
    "condition": {
      "and": [
        { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
        { "u_at_om_location": "boann_sidhe_island" },
        { "math": [ "u_changeling_advancement_condition_found_boanns_island != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_condition_found_boanns_island = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_CAST_DIFFICULTY_5_OR_HIGHER_GLAMOUR",
    "eoc_type": "EVENT",
    "required_event": "spellcasting_finish",
    "condition": {
      "and": [
        { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
        { "math": [ "_difficulty >= 5" ] },
        { "math": [ "_success != false" ] },
        { "math": [ "u_changeling_advancement_condition_cast_difficulty_5_or_higher_glamour != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_condition_cast_difficulty_5_or_higher_glamour = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_REACH_LEVEL_SEVEN_DEDUCTION",
    "eoc_type": "EVENT",
    "required_event": "gains_skill_level",
    "condition": {
      "and": [
        { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
        { "compare_string": [ { "context_val": "skill" }, "deduction" ] },
        { "math": [ "_new_level >= 7" ] },
        { "math": [ "u_changeling_advancement_condition_reach_level_seven_deduction != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_condition_reach_level_seven_deduction = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_CLEAR_ABYSSAL_HUNGER",
    "condition": { "test_eoc": "EOC_CONDITIONS_YOU_ARE_A_PLAYABLE_CHANGELING" },
    "effect": [ { "math": [ "u_changeling_advancement_dreams_counter++" ] } ]
  },
  {
    "//": "Advancement conditions that apply to noble changelings only should go here",
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_NOBLE_CAST_DIFFICULTY_8_OR_HIGHER_GLAMOUR",
    "eoc_type": "EVENT",
    "required_event": "spellcasting_finish",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" },
        { "math": [ "_difficulty >= 8" ] },
        { "math": [ "_success != false" ] },
        { "math": [ "u_changeling_advancement_noble_condition_cast_difficulty_8_or_higher_glamour != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_noble_condition_cast_difficulty_8_or_higher_glamour = 1" ] }
    ]
  },
  {
    "//": "Advancement conditions that apply to noble changelings only should go here",
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_NOBLE_YOU_HAVE_ONE_FOLLOWER",
    "recurrence": [ "1 hours", "1 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" },
        { "npc_allies": 1 },
        { "math": [ "u_changeling_advancement_noble_condition_you_have_one_follower != 1" ] }
      ]
    },
    "deactivate_condition": {
      "or": [
        { "not": { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" } },
        { "math": [ "u_changeling_advancement_noble_condition_you_have_one_follower = 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_noble_condition_you_have_one_follower = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_NOBLE_YOU_HAVES_SEVEN_FOLLOWERS",
    "recurrence": [ "1 hours", "1 hours" ],
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" },
        { "npc_allies": 7 },
        { "math": [ "u_changeling_advancement_noble_condition_you_have_seven_followers != 1" ] }
      ]
    },
    "deactivate_condition": {
      "or": [
        { "not": { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" } },
        { "math": [ "u_changeling_advancement_noble_condition_you_have_seven_followers = 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_noble_condition_you_have_seven_followers = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_NOBLE_REACH_LEVEL_SEVEN_SOCIAL",
    "eoc_type": "EVENT",
    "required_event": "gains_skill_level",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_NOBLE" },
        { "compare_string": [ { "context_val": "skill" }, "speech" ] },
        { "math": [ "_new_level >= 7" ] },
        { "math": [ "u_changeling_advancement_noble_condition_reach_level_seven_social != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_noble_condition_reach_level_seven_social = 1" ] }
    ]
  },
  {
    "//": "Advancement conditions that apply to brownie changelings should go here",
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_BROWNIE_ADVANCEMENT_REACH_LEVEL_SEVEN_FOOD_OR_TAILORING",
    "eoc_type": "EVENT",
    "required_event": "gains_skill_level",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_BROWNIE" },
        {
          "or": [
            { "compare_string": [ { "context_val": "skill" }, "tailor" ] },
            { "compare_string": [ { "context_val": "skill" }, "cooking" ] }
          ]
        },
        { "math": [ "_new_level >= 7" ] },
        { "math": [ "u_changeling_advancement_brownie_condition_reach_level_seven_food_or_tailoring != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_brownie_condition_reach_level_seven_food_or_tailoring = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_BROWNIE_ADVANCEMENT_REACH_SPEND_TWENTY_FOUR_HOURS_INDOORS",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_BROWNIE" },
        { "math": [ "u_brownie_homebody_speed_bonus == 24" ] },
        { "math": [ "u_changeling_advancement_brownie_condition_spend_twenty_four_hours_indoors != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_brownie_condition_spend_twenty_four_hours_indoors = 1" ] }
    ]
  },
  {
    "//": "Advancement conditions that apply to pooka changelings should go here",
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_POOKA_ADVANCEMENT_SPEND_TWENTY_FOUR_HOURS_IN_THE_WILDERNESS",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_POOKA" },
        { "math": [ "u_changeling_advancement_pooka_condition_spend_twenty_four_hours_in_the_wilderness != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_pooka_condition_spend_twenty_four_hours_in_the_wilderness = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_POOKA_REACH_LEVEL_SEVEN_SURVIVAL",
    "eoc_type": "EVENT",
    "required_event": "gains_skill_level",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_POOKA" },
        { "compare_string": [ { "context_val": "skill" }, "survival" ] },
        { "math": [ "_new_level >= 7" ] },
        { "math": [ "u_changeling_advancement_pooka_condition_reach_level_seven_survival != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_pooka_condition_reach_level_seven_survival = 1" ] }
    ]
  },
  {
    "type": "effect_on_condition",
    "id": "EOC_PLAYABLE_CHANGELING_ADVANCEMENT_POOKA_KILL_TRIFFID_HEART",
    "eoc_type": "EVENT",
    "required_event": "character_kills_monster",
    "condition": {
      "and": [
        { "u_has_trait": "UNKNOWING_CHANGELING_COMMONER_POOKA" },
        { "compare_string": [ { "context_val": "victim_type" }, "mon_triffid_heart" ] },
        { "math": [ "u_changeling_advancement_pooka_condition_kill_triffid_heart != 1" ] }
      ]
    },
    "effect": [
      { "math": [ "u_changeling_advancement_dreams_counter++" ] },
      { "math": [ "u_changeling_advancement_pooka_condition_kill_triffid_heart = 1" ] }
    ]
  }
]
